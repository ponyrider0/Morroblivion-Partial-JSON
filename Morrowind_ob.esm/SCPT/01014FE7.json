{
    "Record Header": {
        "Signature": "SCPT", 
        "Record Flags": {}, 
        "FormID": "01014FE7"
    }, 
    "EDID - Editor ID": "mwCWUTargetItemScript", 
    "SCHR - Basic Script Data": {
        "Unused": "00 00 00 00", 
        "RefCount": 21, 
        "CompiledSize": 3702, 
        "VariableCount": 37, 
        "Type": 0
    }, 
    "SCDA - Compiled Script": "1D 00 00 00 10 00 0B 00 06 00 78 00 00 00 01 00 72 01 00 16 00 0F 00 03 00 0B 00 20 66 06 00 20 5A 01 00 20 3D 3D 16 00 0D 00 01 00 09 00 20 66 22 00 20 30 20 21 3D 1C 00 01 00 6B 16 05 00 01 00 72 0A 00 19 00 00 00 19 00 00 00 65 17 22 00 01 21 00 56 01 00 00 0C 00 58 00 00 65 18 13 00 02 08 00 56 04 00 00 05 00 08 00 56 03 0B 00 0B 00 00 76 17 11 00 02 08 00 56 03 0B 00 0B 00 08 00 56 01 00 00 0C 00 11 00 00 00 10 00 08 00 05 00 44 00 00 00 00 00 16 00 22 00 02 00 1E 00 20 66 04 00 20 5A 0C 00 20 21 3D 20 58 52 14 05 00 01 00 72 03 00 20 30 20 3D 3D 20 26 26 15 00 09 00 66 04 00 04 00 20 5A 0C 00 8A 14 05 00 01 00 72 04 00 19 00 00 00 11 00 00 00 10 00 08 00 04 00 F8 01 00 00 00 00 15 00 0B 00 66 03 00 06 00 20 58 50 14 00 00 65 17 22 00 01 21 00 56 01 00 00 0D 00 58 00 00 65 18 13 00 02 08 00 56 04 00 00 03 00 08 00 56 03 0D 00 03 00 00 16 00 13 00 02 00 0F 00 20 73 0D 00 20 39 39 39 39 39 20 7E 20 3D 3D 06 14 76 00 03 00 6C 00 6D 6F 72 72 6F 62 6C 69 76 69 6F 6E 2D 66 69 78 65 73 20 45 52 52 4F 52 3A 20 6D 77 43 57 55 54 61 72 67 65 74 49 74 65 6D 53 63 72 69 70 74 20 28 6C 69 6E 65 20 36 38 29 3A 20 25 6E 28 25 69 29 20 77 61 73 20 6E 6F 74 20 66 6F 75 6E 64 20 69 6E 20 74 68 65 20 69 6E 74 65 72 6E 61 6C 20 73 65 61 72 63 68 20 6C 69 73 74 2E 66 03 00 66 03 00 1E 00 00 00 17 00 02 00 06 00 65 17 17 00 01 16 00 56 04 00 00 04 00 56 03 0D 00 05 00 56 01 00 00 0D 00 18 00 16 00 0F 00 01 00 0B 00 20 58 52 14 05 00 01 00 72 03 00 8A 14 05 00 01 00 72 0E 00 17 00 02 00 01 00 8A 14 05 00 01 00 72 04 00 19 00 00 00 19 00 00 00 15 00 0B 00 66 06 00 06 00 20 58 CF 10 00 00 1C 00 02 00 42 11 05 00 01 00 72 04 00 16 00 0D 00 01 00 09 00 20 66 07 00 20 30 20 3D 3D 65 17 20 00 01 1F 00 56 04 00 00 07 00 58 00 00 83 18 11 00 01 05 00 52 0F 00 01 08 00 56 04 00 00 04 00 00 19 00 00 00 16 00 0F 00 01 00 0B 00 20 66 06 00 20 5A 01 00 20 21 3D 1C 00 02 00 1C 10 05 00 01 00 72 06 00 19 00 00 00 06 14 59 00 05 00 49 00 6D 6F 72 72 6F 62 6C 69 76 69 6F 6E 2D 66 69 78 65 73 3A 20 43 57 55 54 61 72 67 65 74 49 74 65 6D 53 63 72 69 70 74 20 28 38 37 29 3A 20 25 6E 28 25 69 29 20 68 61 73 20 65 71 75 69 70 70 65 64 20 25 6E 28 25 69 29 2E 66 06 00 66 06 00 66 03 00 66 03 00 11 00 00 00 10 00 0B 00 04 00 BA 03 00 00 01 00 72 01 00 16 00 0D 00 02 00 09 00 20 66 04 00 20 30 20 3D 3D 06 14 54 00 02 00 4D 00 4D 6F 72 72 6F 62 6C 69 76 69 6F 6E 2D 66 69 78 65 73 20 45 52 52 4F 52 3A 20 6D 77 43 57 55 54 61 72 67 65 74 49 74 65 6D 53 63 72 69 70 74 20 28 6C 69 6E 65 20 39 30 29 3A 20 6D 79 45 6E 63 68 20 3D 3D 20 30 20 28 20 25 69 20 29 66 04 00 1E 00 00 00 19 00 00 00 15 00 10 00 73 09 00 0B 00 20 58 C4 14 05 00 01 00 72 04 00 15 00 10 00 73 0B 00 0B 00 20 58 C5 14 05 00 01 00 72 04 00 16 00 0D 00 01 00 09 00 20 66 05 00 20 30 20 3D 3D 65 17 28 00 01 27 00 56 04 00 00 05 00 58 00 00 83 18 19 00 01 05 00 52 10 00 02 08 00 56 04 00 00 03 00 08 00 56 01 00 00 09 00 00 19 00 00 00 16 00 0D 00 01 00 09 00 20 66 05 00 20 30 20 21 3D 65 17 20 00 01 1F 00 56 01 00 00 0A 00 58 00 00 83 18 11 00 01 05 00 52 11 00 01 08 00 56 04 00 00 05 00 00 19 00 00 00 16 00 0C 00 02 00 08 00 20 73 0B 00 20 30 20 3E 15 00 0F 00 73 02 00 0A 00 20 73 09 00 20 73 0B 00 20 2F 15 00 0F 00 73 01 00 0A 00 20 73 0A 00 20 73 0B 00 20 2F 19 00 00 00 65 17 22 00 01 21 00 56 01 00 00 0C 00 58 00 00 65 18 13 00 02 08 00 56 04 00 00 05 00 08 00 56 03 0B 00 0B 00 00 16 00 13 00 01 00 0F 00 20 73 0C 00 20 39 39 39 39 39 20 7E 20 3D 3D 49 19 11 00 02 08 00 56 03 0B 00 0B 00 08 00 56 04 00 00 05 00 19 00 00 00 16 00 10 00 15 00 0C 00 20 72 12 00 73 0B 00 20 30 20 3D 3D 76 19 16 00 02 10 00 53 0B 00 4F 6E 53 70 65 6C 6C 43 61 73 74 05 00 52 13 00 B3 10 05 00 01 00 72 06 00 16 00 14 00 01 00 10 00 20 58 CC 16 0A 00 02 00 6E 00 00 00 00 72 03 00 15 00 18 00 72 14 00 73 21 00 10 00 20 58 20 17 0A 00 02 00 6E 00 00 00 00 72 03 00 18 00 0F 00 01 00 0B 00 20 58 CA 16 05 00 01 00 72 03 00 15 00 13 00 72 14 00 73 21 00 0B 00 20 58 1E 17 05 00 01 00 72 03 00 17 00 02 00 01 00 15 00 13 00 72 14 00 73 21 00 0B 00 20 58 1E 17 05 00 01 00 72 04 00 19 00 00 00 3E 17 50 00 03 00 3D 00 68 75 64 6D 61 69 6E 5F 62 61 63 6B 67 72 6F 75 6E 64 5C 68 75 64 6D 61 69 6E 5F 4D 61 67 69 63 5F 49 63 6F 6E 5C 66 69 6C 65 6E 61 6D 65 7C 4D 65 6E 75 73 5C 49 63 6F 6E 73 5C 25 7A 72 14 00 73 21 00 7A 00 00 00 00 00 60 8F 40 FE 16 09 00 01 08 00 56 02 14 00 21 00 15 00 10 00 72 14 00 66 02 00 08 00 20 58 89 14 02 00 00 00 15 00 0C 00 72 14 00 66 19 00 04 00 20 66 07 00 15 00 0E 00 72 14 00 66 03 00 06 00 20 58 50 14 00 00 15 00 0C 00 72 14 00 73 04 00 04 00 20 73 01 00 15 00 0C 00 72 14 00 73 08 00 04 00 20 73 02 00 15 00 0C 00 72 14 00 66 14 00 04 00 20 66 05 00 15 00 0C 00 72 14 00 73 1E 00 04 00 20 73 09 00 15 00 0C 00 72 14 00 73 20 00 04 00 20 73 0A 00 15 00 0C 00 72 14 00 73 1F 00 04 00 20 73 0B 00 15 00 0A 00 72 14 00 73 1B 00 02 00 20 31 19 00 00 00 16 00 0D 00 03 00 09 00 20 66 22 00 20 30 20 3D 3D 15 00 09 00 66 1F 00 04 00 20 5A 15 00 15 00 10 00 66 22 00 0B 00 20 58 B5 14 05 00 01 00 72 07 00 D1 16 0D 00 03 00 03 00 2B 25 6E 66 03 00 66 22 00 19 00 00 00 1C 00 01 00 6A 16 05 00 01 00 72 0A 00 11 00 00 00 10 00 08 00 01 00 9F 04 00 00 00 00 16 00 0D 00 01 00 09 00 20 66 03 00 20 30 20 3D 3D 15 00 0B 00 66 03 00 06 00 20 58 50 14 00 00 19 00 00 00 16 00 0D 00 1F 00 09 00 20 66 07 00 20 30 20 21 3D 15 00 0B 00 66 1D 00 06 00 20 58 07 14 00 00 16 00 0F 00 1C 00 0B 00 20 66 1D 00 20 66 22 00 20 3D 3D 16 00 17 00 05 00 13 00 20 72 01 00 58 B6 10 05 00 01 00 72 03 00 20 30 20 3D 3D 16 00 22 00 02 00 1E 00 20 66 04 00 20 5A 0C 00 20 21 3D 20 58 52 14 05 00 01 00 72 03 00 20 30 20 3D 3D 20 26 26 15 00 09 00 66 04 00 04 00 20 5A 0C 00 8A 14 05 00 01 00 72 04 00 19 00 00 00 1C 00 01 00 68 16 05 00 01 00 72 03 00 19 00 00 00 76 19 16 00 02 10 00 53 0B 00 4F 6E 53 70 65 6C 6C 43 61 73 74 05 00 52 13 00 B3 10 05 00 01 00 72 06 00 16 00 14 00 01 00 10 00 20 58 CC 16 0A 00 02 00 6E 00 00 00 00 72 03 00 15 00 18 00 72 14 00 73 21 00 10 00 20 58 20 17 0A 00 02 00 6E 00 00 00 00 72 03 00 18 00 0F 00 01 00 0B 00 20 58 CA 16 05 00 01 00 72 03 00 15 00 13 00 72 14 00 73 21 00 0B 00 20 58 1E 17 05 00 01 00 72 03 00 17 00 02 00 01 00 15 00 13 00 72 14 00 73 21 00 0B 00 20 58 1E 17 05 00 01 00 72 04 00 19 00 00 00 3E 17 50 00 03 00 3D 00 68 75 64 6D 61 69 6E 5F 62 61 63 6B 67 72 6F 75 6E 64 5C 68 75 64 6D 61 69 6E 5F 4D 61 67 69 63 5F 49 63 6F 6E 5C 66 69 6C 65 6E 61 6D 65 7C 4D 65 6E 75 73 5C 49 63 6F 6E 73 5C 25 7A 72 14 00 73 21 00 7A 00 00 00 00 00 60 8F 40 FE 16 09 00 01 08 00 56 02 14 00 21 00 15 00 10 00 72 14 00 66 02 00 08 00 20 58 89 14 02 00 00 00 15 00 0C 00 72 14 00 66 19 00 04 00 20 66 07 00 15 00 0E 00 72 14 00 66 03 00 06 00 20 58 50 14 00 00 15 00 0C 00 72 14 00 73 04 00 04 00 20 73 01 00 15 00 0C 00 72 14 00 73 08 00 04 00 20 73 02 00 15 00 0C 00 72 14 00 66 14 00 04 00 20 66 05 00 15 00 0C 00 72 14 00 73 1E 00 04 00 20 73 09 00 15 00 0C 00 72 14 00 73 20 00 04 00 20 73 0A 00 15 00 0C 00 72 14 00 73 1F 00 04 00 20 73 0B 00 15 00 0A 00 72 14 00 73 1B 00 02 00 20 31 19 00 00 00 19 00 00 00 16 00 21 00 0F 00 1D 00 20 58 24 10 07 00 01 00 6E EA 03 00 00 20 58 24 10 07 00 01 00 6E F0 03 00 00 20 7C 7C 15 00 0D 00 66 1B 00 08 00 20 58 D9 16 02 00 00 00 16 00 0F 00 0C 00 0B 00 20 66 1B 00 20 66 03 00 20 3D 3D 16 00 0D 00 01 00 09 00 20 66 04 00 20 30 20 3D 3D 15 00 0D 00 66 04 00 08 00 20 58 89 14 02 00 00 00 19 00 00 00 15 00 15 00 73 08 00 10 00 20 58 BD 14 0A 00 02 00 72 04 00 6E 00 00 00 00 16 00 0D 00 01 00 09 00 20 66 05 00 20 30 20 21 3D 65 17 20 00 01 1F 00 56 01 00 00 0A 00 58 00 00 83 18 11 00 01 05 00 52 11 00 01 08 00 56 04 00 00 05 00 00 19 00 00 00 16 00 0C 00 01 00 08 00 20 73 0B 00 20 30 20 3E 15 00 0F 00 73 01 00 0A 00 20 73 0A 00 20 73 0B 00 20 2F 19 00 00 00 3E 17 A5 00 08 00 86 00 6D 61 67 69 63 70 6F 70 5F 66 61 6B 65 5F 62 61 63 6B 67 72 6F 75 6E 64 5C 6D 61 67 69 63 70 6F 70 5F 62 61 63 6B 67 72 6F 75 6E 64 5C 6D 61 67 69 63 70 6F 70 5F 62 61 63 6B 67 72 6F 75 6E 64 5F 62 6F 74 74 6F 6D 5C 73 74 72 69 6E 67 7C 43 68 61 72 67 65 3A 20 25 2E 30 66 2F 25 2E 30 66 20 55 73 65 73 3A 20 25 2E 30 66 2F 25 2E 30 66 25 7B 0A 44 75 72 61 74 69 6F 6E 3A 20 25 2E 30 66 20 73 2E 25 7D 73 0A 00 73 09 00 73 01 00 73 02 00 73 08 00 73 08 00 7A 00 00 00 00 00 00 90 40 3E 17 8C 00 08 00 6D 00 6D 61 67 69 63 70 6F 70 5F 62 61 63 6B 67 72 6F 75 6E 64 5C 6D 61 67 69 63 70 6F 70 5F 62 61 63 6B 67 72 6F 75 6E 64 5F 62 6F 74 74 6F 6D 5C 73 74 72 69 6E 67 7C 43 68 61 72 67 65 3A 20 25 2E 30 66 2F 25 2E 30 66 20 55 73 65 73 3A 20 25 2E 30 66 2F 25 2E 30 66 25 7B 0A 44 75 72 61 74 69 6F 6E 3A 20 25 2E 30 66 20 73 2E 25 7D 73 0A 00 73 09 00 73 01 00 73 02 00 73 08 00 73 08 00 7A 00 00 00 00 00 00 90 40 19 00 00 00 19 00 00 00 11 00 00 00 10 00 06 00 00 00 19 03 00 00 16 00 25 00 01 00 21 00 20 66 03 00 20 30 20 3D 3D 20 66 04 00 20 30 20 3D 3D 20 7C 7C 20 66 06 00 20 30 20 3D 3D 20 7C 7C 1E 00 00 00 19 00 00 00 16 00 0F 00 20 00 0B 00 20 66 06 00 20 5A 01 00 20 3D 3D 16 00 17 00 05 00 13 00 20 72 01 00 58 B6 10 05 00 01 00 72 03 00 20 30 20 3D 3D 16 00 22 00 03 00 1E 00 20 66 04 00 20 5A 0C 00 20 21 3D 20 58 52 14 05 00 01 00 72 03 00 20 30 20 3D 3D 20 26 26 06 14 5F 00 03 00 55 00 43 57 55 54 61 72 67 65 74 49 74 65 6D 53 63 72 69 70 74 20 64 65 62 75 67 20 28 6C 69 6E 65 20 32 32 33 29 3A 20 25 6E 28 25 69 29 20 6E 6F 20 6C 6F 6E 67 65 72 20 65 71 75 69 70 70 65 64 2C 20 72 65 6D 6F 76 69 6E 67 20 65 6E 63 68 61 6E 74 6D 65 6E 74 66 03 00 66 03 00 15 00 09 00 66 04 00 04 00 20 5A 0C 00 8A 14 05 00 01 00 72 04 00 19 00 00 00 19 00 00 00 16 00 0D 00 17 00 09 00 20 66 07 00 20 30 20 21 3D 15 00 0B 00 66 1D 00 06 00 20 58 07 14 00 00 16 00 0F 00 14 00 0B 00 20 66 1D 00 20 66 22 00 20 3D 3D 16 00 17 00 05 00 13 00 20 72 01 00 58 B6 10 05 00 01 00 72 03 00 20 30 20 3D 3D 16 00 22 00 02 00 1E 00 20 66 04 00 20 5A 0C 00 20 21 3D 20 58 52 14 05 00 01 00 72 03 00 20 30 20 3D 3D 20 26 26 15 00 09 00 66 04 00 04 00 20 5A 0C 00 8A 14 05 00 01 00 72 04 00 19 00 00 00 1C 00 01 00 68 16 05 00 01 00 72 03 00 19 00 00 00 76 19 16 00 02 10 00 53 0B 00 4F 6E 53 70 65 6C 6C 43 61 73 74 05 00 52 13 00 B3 10 05 00 01 00 72 06 00 15 00 10 00 72 14 00 66 02 00 08 00 20 58 89 14 02 00 00 00 15 00 0C 00 72 14 00 66 19 00 04 00 20 66 07 00 15 00 0E 00 72 14 00 66 03 00 06 00 20 58 50 14 00 00 15 00 0C 00 72 14 00 73 04 00 04 00 20 73 01 00 15 00 0C 00 72 14 00 73 08 00 04 00 20 73 02 00 15 00 0C 00 72 14 00 66 14 00 04 00 20 66 05 00 15 00 0C 00 72 14 00 73 1E 00 04 00 20 73 09 00 15 00 0C 00 72 14 00 73 20 00 04 00 20 73 0A 00 15 00 0C 00 72 14 00 73 1F 00 04 00 20 73 0B 00 15 00 0A 00 72 14 00 73 1B 00 02 00 20 31 1E 00 00 00 19 00 00 00 19 00 00 00 19 00 00 00 16 00 12 00 01 00 0E 00 20 72 02 00 58 DF 10 05 00 01 00 72 04 00 1C 00 02 00 42 11 05 00 01 00 72 04 00 19 00 00 00 16 00 23 00 05 00 1F 00 20 66 03 00 20 72 14 00 66 03 00 20 3D 3D 20 66 07 00 20 72 14 00 66 19 00 20 3D 3D 20 26 26 15 00 0C 00 73 0A 00 07 00 20 72 14 00 73 20 00 16 00 0C 00 01 00 08 00 20 73 0B 00 20 30 20 3E 15 00 0F 00 73 01 00 0A 00 20 73 0A 00 20 73 0B 00 20 2F 19 00 00 00 15 00 0C 00 72 14 00 73 04 00 04 00 20 73 01 00 19 00 00 00 11 00 00 00", 
    "SCTX - Script Source": "; Universal Cast When Used OnTarget - Item Script\n;\t** Please see mwCWUItemScript for description of how CWU works. **\n;\tThis script is attached to clothing or armor piece that has a Targeted\n;\tCast-When-Used enchantment. In order to prevent a targeted CWU enchantment\n;\tfrom errantly casting a potentially hostile spell whenever the item is\n;\tequipped, the item's unequipped state contains a placeholder enchantment\n;\tcontaining no magic effect.  This is dynamically replaced with the real\n;\ttargeted CWU enchantment when the item is equipped.  When the item is\n;\tunequipped, the placeholder enchantment is put back on the item.\n;\n;\tThis script relies on the CWUTargetQuestScript to provide a\tpaired list \n;\tof targetted CWU items BaseIDs and their true enchantments.\n;\nscn mwCWUTargetItemScript\n\nshort uses\nshort baseuses\n\nref me\nref myEnch\nref myWeap\nref myActor\nref mySpell\nlong dur\n\nshort ChargeMax\nshort ChargeCurrent\nshort ChargeCost\n\nshort index\nlong item_search\n\nref tempRef\nref menuSelection\n\nref currentActiveSpell\nref proxySpell\n\nbegin OnDrop Player\n\tif (myActor == Player)\n\t\tif (proxySpell != 0)\n\t\t\tplayer.RemoveSpellNS proxySpell\n\t\tendif\n\tendif\n\n\tLet index := ar_Find myWeap mwCWUInit.Inventory\n\tar_Erase mwCWUInit.Inventory index\nend\n\nbegin OnUnEquip\n\n\t; reset item's enchantment to placeholder (workaround for instant-cast on equip bug)\n\tif (myEnch != mwCWUTargetEn) && (IsWeapon me == 0)\n\t\tset myEnch to mwCWUTargetEn\n\t\tSetEnchantment myEnch\n\tendif\n\nend\n\nbegin OnEquip\n\n\tset me to GetBaseObject\n\n\tlet item_search := ar_Find me mwCWUTargetQuest.itemList\n\tif (item_search == -99999)\n\t\tPrintC \"morroblivion-fixes ERROR: mwCWUTargetItemScript (line 68): %n(%i) was not found in the internal search list.\", me, me\n\t\treturn\n\telse\n\t\tlet myEnch := mwCWUTargetQuest.itemEnchantmentMap[item_search]\n\t\tif (IsWeapon me)\n\t\t\t; if weapon, then keep placeholder enchantment -- otherwise will break engine\n\t\t\tSetEnchantment mwCWUDummyWeaponEnch\n\t\telse\n\t\t\t; only replace placeholder enchantment if item is a non-weapon\n\t\t\tSetEnchantment myEnch\n\t\tendif\n\tendif\n\n\tset myActor to GetContainer\n\tmyActor.Dispel myEnch\n\tif mySpell == 0\n\t\tLet mySpell := Call mwCWUSpellCreationFunc myEnch\n\tendif\n\tif myActor != Player\n\t\tmyActor.AddSpell mySpell\n\tendif\n\tPrintC \"morroblivion-fixes: CWUTargetItemScript (87): %n(%i) has equipped %n(%i).\", myActor, myActor, me, me\n\nend\n\nbegin OnEquip Player\n\n\tif (myEnch == 0)\n\t\tprintc \"Morroblivion-fixes ERROR: mwCWUTargetItemScript (line 90): myEnch == 0 ( %i )\", myEnch\n\t\treturn\n\tendif\n\n\tset ChargeMax to GetEnchantmentCharge myEnch\n\tset ChargeCost to GetEnchantmentCost myEnch\n\t\n\tif myWeap == 0\n\t\tLet myWeap := Call mwCWUSetupWeaponTokenFunc me ChargeMax\n\tendif\n\n\tif myWeap != 0\n\t\tLet ChargeCurrent := Call mwCWUGetCurrentChargeFunc myWeap\n\tendif\n\n\tif ChargeCost > 0\n\t\tset baseuses to ChargeMax / ChargeCost\n\t\tset uses to ChargeCurrent / ChargeCost\n\tendif\n\n\tLet index := ar_Find myWeap mwCWUInit.Inventory\n\tif index == -99999\n\t\tar_Append mwCWUInit.Inventory myWeap\n\tendif\n\n; This is the original code which selected the enchantment spell as soon as the item was equipped.\n; The new method is to require selection of the enchantment through the magic menu.  This avoids\n; the need to un-equip/re-equip items to reselect an enchantment.\n; ------------------ Select Enchantment On Equip -------------------------\n\tif (mwFixes.StrictMWEnchantmentSelection == 0)\n\t\tRemoveEventHandler \"OnSpellCast\" mwCWUCastEventHandler\n\t\tSelectPlayerSpell mySpell\n\t\tif (IsBipedIconPathValid 0 me)\n\t\t\tset mwCWU.IconString to GetBipedIconPath 0 me\n\t\telseif (IsIconPathValid me)\n\t\t\tset mwCWU.IconString to GetIconPath me\n\t\telse\n\t\t\tset mwCWU.IconString to GetIconPath myEnch\n\t\tendif\n\t\tSetMenuStringValue \"hudmain_background\\hudmain_Magic_Icon\\filename|Menus\\Icons\\%z\" mwCWU.IconString 1004\n\t\tsv_Destruct mwCWU.IconString\n\t\t;===Setting Variables needed for Quest part\n\t\tset mwCWU.Ench to GetEnchantment\n;\t\tset mwCWU.Ench to myEnch\n\t\tset mwCWU.ItemSpell to mySpell\n\t\tset mwCWU.Item to GetBaseObject\n\t\tset mwCWU.Itemuses to uses\n\t\tset mwCWU.Itemusesmax to baseuses\n\t\tset mwCWU.ItemWeap to myWeap\n\t\tset mwCWU.ItemChargeMax to ChargeMax\n\t\tset mwCWU.ItemChargeCurrent to ChargeCurrent\n\t\tset mwCWU.ItemChargeCost to ChargeCost\n\t\tset mwCWU.onplayer to 1\n\tendif\n\n\tif (proxySpell == 0)\n\t\tset tempRef to mwCWUProxySpell\n\t\tset proxySpell to CloneForm tempRef\n\t\tSetNameEx \"+%n\", me, proxySpell\n\tendif\n\n\tplayer.AddSpellNS proxySpell\t\n\t\t\t\nend\n\nbegin MenuMode\n\tif me == 0\n\t\tset me to GetBaseObject\n\tendif\n\n\t; Detect proxyScroll activation\n\tif (mySpell != 0)\n\t\tset currentActiveSpell to GetPlayerSpell\n\t\tif (currentActiveSpell == proxySpell) \t\t\t\n\t\t\t; equip enchanted item if not already equipped\n\t\t\tif (player.GetEquipped me == 0)\t\t\t\n\t\t\t\t; sanity check to make sure that the true enchantment is removed before equipping (workaround for cast-on-equip bug)\n\t\t\t\tif (myEnch != mwCWUTargetEn) && (IsWeapon me == 0)\n\t\t\t\t\tset myEnch to mwCWUTargetEn\n\t\t\t\t\tSetEnchantment myEnch\n\t\t\t\tendif\n\t\t\t\tPlayer.EquipItemNS me\n\t\t\tendif\n\n\t\t\tRemoveEventHandler \"OnSpellCast\" mwCWUCastEventHandler\n\t\t\tSelectPlayerSpell mySpell\n\t\t\t; set the active spell icon\n;\t\t\tset mwCWU.IconString to GetBipedIconPath 0 me\n\t\t\tif (IsBipedIconPathValid 0 me)\n\t\t\t\tset mwCWU.IconString to GetBipedIconPath 0 me\n\t\t\telseif (IsIconPathValid me)\n\t\t\t\tset mwCWU.IconString to GetIconPath me\n\t\t\telse\n\t\t\t\tset mwCWU.IconString to GetIconPath myEnch\n\t\t\tendif\n\t\t\tSetMenuStringValue \"hudmain_background\\hudmain_Magic_Icon\\filename|Menus\\Icons\\%z\" mwCWU.IconString 1004\n\t\t\tsv_Destruct mwCWU.IconString\n\t\t\t\t;===Setting Variables needed for Quest part\n\t\t\tset mwCWU.Ench to GetEnchantment\n;\t\t\tset mwCWU.Ench to myEnch\n\t\t\tset mwCWU.ItemSpell to mySpell\n\t\t\tset mwCWU.Item to GetBaseObject\n\t\t\tset mwCWU.Itemuses to uses\n\t\t\tset mwCWU.Itemusesmax to baseuses\n\t\t\tset mwCWU.ItemWeap to myWeap\n\t\t\tset mwCWU.ItemChargeMax to ChargeMax\n\t\t\tset mwCWU.ItemChargeCurrent to ChargeCurrent\n\t\t\tset mwCWU.ItemChargeCost to ChargeCost\n\t\t\tset mwCWU.onplayer to 1\n\t\tendif\n\tendif\n\t\n\tif MenuMode 1002 || MenuMode 1008\n\n\t\tset menuSelection to GetActiveMenuSelection\n\n; ------------- MouseOver Enchantment \"tooltip\" info ----------\t\t\n\t\tif (menuSelection == me)\n\t\t\tif (myEnch == 0)\n\t\t\t\tset myEnch to GetEnchantment\n\t\t\tendif\n\n\t\t\tset dur to GetNthEffectItemDuration myEnch 0\n\n\t\t\tif myWeap != 0\n\t\t\t\tLet ChargeCurrent := Call mwCWUGetCurrentChargeFunc myWeap\n\t\t\tendif\n\n\t\t\tif ChargeCost > 0\n\t\t\t\tset uses to ChargeCurrent / ChargeCost\n\t\t\tendif\n\n\t\t\tSetMenuStringValue \"magicpop_fake_background\\magicpop_background\\magicpop_background_bottom\\string|Charge: %.0f/%.0f Uses: %.0f/%.0f%{%rDuration: %.0f s.%}\" ChargeCurrent ChargeMax uses baseuses dur dur 1024\n\t\t\tSetMenuStringValue \"magicpop_background\\magicpop_background_bottom\\string|Charge: %.0f/%.0f Uses: %.0f/%.0f%{%rDuration: %.0f s.%}\" ChargeCurrent ChargeMax uses baseuses dur dur 1024\n\t\tendif\n\n\tendif\nend\n\nbegin GameMode\n\n\tif (me == 0) || (myEnch == 0) || (myActor == 0)\n\t\treturn\n\tendif\n\n\t; Make sure enchantment is removed if item is not equipped\n\tif (myActor == player) \n\n\t\t; detect any programmatic unequipping that left real enchantment active\n\t\tif (player.GetEquipped me == 0)\n\t\t\tif (myEnch != mwCWUTargetEn) && (IsWeapon me == 0)\n\t\t\t\tPrintC \"CWUTargetItemScript debug (line 223): %n(%i) no longer equipped, removing enchantment\", me, me\n\t\t\t\tset myEnch to mwCWUTargetEn\n\t\t\t\tSetEnchantment myEnch\n\t\t\tendif\n\t\tendif\n\n\t\t; Detect proxySpell activation\n\t\tif (mySpell != 0)\n\t\t\tset currentActiveSpell to GetPlayerSpell\n\t\t\tif (currentActiveSpell == proxySpell) \n;\t\t\t\tprintc \"CWUTargetItemScript (line 234): ActiveSpell=[%n](%i) , mySpell=[%n](%i)\", currentActiveSpell, currentActiveSpell, mySpell, mySpell\n\t\t\t\t; equip enchanted item if not already equipped\n\t\t\t\tif (player.GetEquipped me == 0)\t\t\t\n\t\t\t\t\t; sanity check to make sure that the true enchantment is removed before equipping (workaround for cast-on-equip bug)\n\t\t\t\t\tif (myEnch != mwCWUTargetEn) && (IsWeapon me == 0)\n\t\t\t\t\t\tset myEnch to mwCWUTargetEn\n\t\t\t\t\t\tSetEnchantment myEnch\n\t\t\t\t\tendif\n\t\t\t\t\tPlayer.EquipItemNS me\n\t\t\t\tendif\n\n\t\t\t\tRemoveEventHandler \"OnSpellCast\" mwCWUCastEventHandler\n\t\t\t\tSelectPlayerSpell mySpell\n\t\t\t\t;===Setting Variables needed for Quest part\n\t\t\t\tset mwCWU.Ench to GetEnchantment\n;\t\t\t\tset mwCWU.Ench to myEnch\n\t\t\t\tset mwCWU.ItemSpell to mySpell\n\t\t\t\tset mwCWU.Item to GetBaseObject\n\t\t\t\tset mwCWU.Itemuses to uses\n\t\t\t\tset mwCWU.Itemusesmax to baseuses\n\t\t\t\tset mwCWU.ItemWeap to myWeap\n\t\t\t\tset mwCWU.ItemChargeMax to ChargeMax\n\t\t\t\tset mwCWU.ItemChargeCurrent to ChargeCurrent\n\t\t\t\tset mwCWU.ItemChargeCost to ChargeCost\n\t\t\t\tset mwCWU.onplayer to 1\t\t\t\t\n\t\t\t\treturn\n\t\t\tendif\n\t\tendif\n\t\t\t\n\tendif\n\n\tif myActor.IsSpellTarget myEnch\n\t\tmyActor.Dispel myEnch\n\tendif\n\n\t; if me == currently active enchant item, then update local data with active enchant item values\n\tif me == mwCWU.Item && mySpell == mwCWU.ItemSpell\n;\t\tprintc \"CWU OnTarget: %n(%i) - enchantment active\", me, me\n\t\tset ChargeCurrent to mwCWU.ItemChargeCurrent\n\t\tif ChargeCost > 0\n\t\t\tset uses to ChargeCurrent / ChargeCost\n\t\tendif\n\t\tset mwCWU.Itemuses to uses\n\n\tendif\n\nend", 
    "Local Variables": [
        {
            "SLSD - Local Variable Data": {
                "Index": 1, 
                "Unused": "00 00 00 00 00 00 00", 
                "Flags": {
                    "IsLongOrShort": true
                }
            }, 
            "SCVR - Name": "uses"
        }, 
        {
            "SLSD - Local Variable Data": {
                "Index": 2, 
                "Unused": "00 00 00 00 00 00 00", 
                "Flags": {
                    "IsLongOrShort": true
                }
            }, 
            "SCVR - Name": "baseuses"
        }, 
        {
            "SLSD - Local Variable Data": {
                "Index": 3, 
                "Unused": "00 00 00 00 00 00 00", 
                "Flags": {}
            }, 
            "SCVR - Name": "me"
        }, 
        {
            "SLSD - Local Variable Data": {
                "Index": 4, 
                "Unused": "00 00 00 00 00 00 00", 
                "Flags": {}
            }, 
            "SCVR - Name": "myEnch"
        }, 
        {
            "SLSD - Local Variable Data": {
                "Index": 5, 
                "Unused": "00 00 00 00 00 00 00", 
                "Flags": {}
            }, 
            "SCVR - Name": "myWeap"
        }, 
        {
            "SLSD - Local Variable Data": {
                "Index": 6, 
                "Unused": "00 00 00 00 00 00 00", 
                "Flags": {}
            }, 
            "SCVR - Name": "myActor"
        }, 
        {
            "SLSD - Local Variable Data": {
                "Index": 7, 
                "Unused": "00 00 00 00 00 00 00", 
                "Flags": {}
            }, 
            "SCVR - Name": "mySpell"
        }, 
        {
            "SLSD - Local Variable Data": {
                "Index": 8, 
                "Unused": "00 00 00 00 00 00 00", 
                "Flags": {
                    "IsLongOrShort": true
                }
            }, 
            "SCVR - Name": "dur"
        }, 
        {
            "SLSD - Local Variable Data": {
                "Index": 9, 
                "Unused": "00 00 00 00 00 00 00", 
                "Flags": {
                    "IsLongOrShort": true
                }
            }, 
            "SCVR - Name": "ChargeMax"
        }, 
        {
            "SLSD - Local Variable Data": {
                "Index": 10, 
                "Unused": "00 00 00 00 00 00 00", 
                "Flags": {
                    "IsLongOrShort": true
                }
            }, 
            "SCVR - Name": "ChargeCurrent"
        }, 
        {
            "SLSD - Local Variable Data": {
                "Index": 11, 
                "Unused": "00 00 00 00 00 00 00", 
                "Flags": {
                    "IsLongOrShort": true
                }
            }, 
            "SCVR - Name": "ChargeCost"
        }, 
        {
            "SLSD - Local Variable Data": {
                "Index": 12, 
                "Unused": "00 00 00 00 00 00 00", 
                "Flags": {
                    "IsLongOrShort": true
                }
            }, 
            "SCVR - Name": "index"
        }, 
        {
            "SLSD - Local Variable Data": {
                "Index": 13, 
                "Unused": "00 00 00 00 00 00 00", 
                "Flags": {
                    "IsLongOrShort": true
                }
            }, 
            "SCVR - Name": "item_search"
        }, 
        {
            "SLSD - Local Variable Data": {
                "Index": 27, 
                "Unused": "00 00 00 00 00 00 00", 
                "Flags": {}
            }, 
            "SCVR - Name": "menuSelection"
        }, 
        {
            "SLSD - Local Variable Data": {
                "Index": 29, 
                "Unused": "00 00 00 00 00 00 00", 
                "Flags": {}
            }, 
            "SCVR - Name": "currentActiveSpell"
        }, 
        {
            "SLSD - Local Variable Data": {
                "Index": 31, 
                "Unused": "00 00 00 00 00 00 00", 
                "Flags": {}
            }, 
            "SCVR - Name": "tempRef"
        }, 
        {
            "SLSD - Local Variable Data": {
                "Index": 34, 
                "Unused": "00 00 00 00 00 00 00", 
                "Flags": {}
            }, 
            "SCVR - Name": "proxySpell"
        }
    ], 
    "References": [
        20, 
        6, 
        3, 
        4, 
        5, 
        7, 
        31, 
        27, 
        29, 
        34, 
        "mwCWUInit", 
        "mwCWUTargetEn", 
        "mwCWUTargetQuest", 
        "mwCWUDummyWeaponEnch", 
        "mwCWUSpellCreationFunc", 
        "mwCWUSetupWeaponTokenFunc", 
        "mwCWUGetCurrentChargeFunc", 
        "mwFixes", 
        "mwCWUCastEventHandler", 
        "mwCWU", 
        "mwCWUProxySpell"
    ]
}